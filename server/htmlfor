<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wikibase REST API Search and Item Details</title>
</head>
<body>
  <h1>Wikibase REST API Entity Search and Item Details</h1>
  <input type="text" id="searchInput" placeholder="Enter search term">
  <button onclick="searchEntities()">Search</button>
  <div id="results"></div>
  <div id="itemDetails"></div>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script>
    const searchEntities = async () => {
      const searchTerm = document.getElementById('searchInput').value;
      const endpoint = 'https://www.wikidata.org/w/rest.php/wikibase/v0/entities';

      const params = {
        search: searchTerm,
        language: 'en',
        limit: 7,
        uselang: 'en'
      };

      try {
        const response = await axios.get(endpoint, { params });
        displayResults(response.data);
      } catch (error) {
        console.error('Error fetching entities:', error);
        document.getElementById('results').innerText = 'Error fetching entities.';
      }
    };

    const displayResults = (data) => {
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (data.entities && data.entities.length > 0) {
        data.entities.forEach(entity => {
          const entityDiv = document.createElement('div');
          entityDiv.innerHTML = `<strong>${entity.label}</strong>: ${entity.description || 'No description available'} 
            <button onclick="fetchItemDetails('${entity.id}')">Details</button>`;
          resultsDiv.appendChild(entityDiv);
        });
      } else {
        resultsDiv.innerText = 'No results found.';
      }
    };

    const fetchItemDetails = async (itemId) => {
      const endpoint = `https://www.wikidata.org/w/rest.php/wikibase/v0/entities/items/${itemId}`;

      try {
        const response = await axios.get(endpoint);
        displayItemDetails(response.data);
      } catch (error) {
        console.error('Error fetching item details:', error);
        document.getElementById('itemDetails').innerText = 'Error fetching item details.';
      }
    };

    const displayItemDetails = (data) => {
      const itemDetailsDiv = document.getElementById('itemDetails');
      itemDetailsDiv.innerHTML = '';

      const item = data.entities[0];
      if (item) {
        const detailsDiv = document.createElement('div');
        detailsDiv.innerHTML = `
          <h2>${item.label}</h2>
          <p>${item.description || 'No description available'}</p>
          <pre>${JSON.stringify(item, null, 2)}</pre>
        `;
        itemDetailsDiv.appendChild(detailsDiv);
      } else {
        itemDetailsDiv.innerText = 'Item details not found.';
      }
    };
  </script>
</body>
</html>
